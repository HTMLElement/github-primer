<!DOCTYPE html>
<html>
<head>
  <link rel="import" href="_loader.html" />
</head>
<body>
  <template>
    <style inline type="text/css" src="../css/base.css"></style>
    <style inline type="text/css" src="../css/tabnav.css"></style>
  </template>
  <script>

    (function() {
      githubPrimer.registerElement('primer-tabnav', {
        create: function (ownerDocument, document) {

          var div = document.createElement('div');
          div.classList.add('tabnav');

          var nav = document.createElement('nav');
          nav.classList.add('tabnav-tabs');

          if (this.hasAttribute('aria-label')) {
            nav.setAttribute('aria-label', this.getAttribute('aria-label'));
          }

          children = Array.from(this.children);
          var shadowRoot = this.attachShadow({ mode: 'open' });
          
          children.forEach((child, i) => {

            if (child.tagName.toLowerCase() === "item") {
              child.classList.add('tabnav-tab');
              if (isChildSelected(child)) {
                child.classList.add('selected');
                child.setAttribute('aria-current', 'page');
              }
              nav.appendChild(child);
            } else {
              child.classList.add('float-right');
              if (isTabnavExtra(child)) {
                child.classList.add('tabnav-extra');
              }
              div.appendChild(child);
            }

          });

          div.appendChild(nav);
          shadowRoot.appendChild(div);
          return shadowRoot;

        }
      });

      function isChildSelected(child) {
        if (!child.hasAttribute('selected')) {
          return false;
        }
        return (child.getAttribute('selected').toLowerCase() !== 'false');
      }

      function isTabnavExtra(child) {
        if (child.hasAttribute('extra')) {
          return !(child.getAttribute('extra').toLowerCase() === 'false');
        }
        return false        
      }

    })();

  </script>
</body>
</html>
